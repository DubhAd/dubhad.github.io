---
layout: post
title: Triggers and conditions and actions! Oh My!
date: '2018-08-18T15:19:00.000+01:00'
author: Tinkerer
tags:
- automation
- home assistant
modified_time: '2018-09-05T21:24:38.258+01:00'
---

<a href="https://www.home-assistant.io/docs/automation/">Automations in Home Assistant</a> can seem a little daunting at first. You look at the documents, and it can seem overwhelming.<br /><br />It's not that bad, honest. It can be summarised like this:<br /><ul><li>Trigger - the things that cause an automation to be started</li><li>Condition - an optional list of things that must be true for the actions to run</li><li>Action - what to do</li></ul><h3><a href="https://home-assistant.io/docs/automation/trigger/">Trigger</a></h3><div>You need at least one trigger, and you can have many if you need them. Once <i>any</i>&nbsp;of them becomes true, then the automation will run. These always use an <kbd>or</kbd> logic - this <kbd>or</kbd> that <kbd>or</kbd> that <kbd>or</kbd>...</div><div><br /></div><div>For example:</div><div><pre>trigger:<br />- platform: state<br />  entity_id: sensor.dice_d20_green<br />  state: 1<br />- platform: state<br />  entity_id: sensor.dice_d20_blue<br />  state: 1</pre></div>Here the automation will run if either our green or blue D20 dice rolls a one. <br /><h3><a href="https://www.home-assistant.io/docs/automation/condition/">Condition</a></h3><div>Here's where we can optionally perform a number of checks before we run those actions. Maybe you only care if that green dice rolls a one during the day, and the blue one at night, or it's Sunday. Conditions are all <kbd>and</kbd> by default - they all have to be true, but as we'll show here, you can use both <kbd>and</kbd> and <kbd>or</kbd> logic as you need.<br /><pre>condition:<br />- condition: or<br />  conditions:<br />  # Sunday<br />  - condition: time<br />    weekday:<br />      - sun<br />  - condition: and<br />    conditions:<br />    # Green D20 rolled one at night<br />    - condition: state<br />      entity_id: sensor.dice_d20_green<br />      state: 1<br />    - condition: template<br />      value_template: '{{ "{{" }} states.sun.sun.attributes.elevation &lt; 0 }}'<br />  - condition: and<br />    conditions:<br />    # Blue D20 rolled one during the day<br />    - condition: state<br />      entity_id: sensor.dice_d20_blue<br />      state: 1<br />    - condition: template<br />      value_template: '{{ "{{" }} states.sun.sun.attributes.elevation &gt;= 0 }}'</pre></div><h3><a href="https://www.home-assistant.io/docs/automation/action/">Action</a></h3><div>Finally, we're at the "go do" part. These are <a href="https://www.home-assistant.io/docs/scripts/">scripts</a>, just embedded in your automation. There are four different things you can do here, and the actions are processed in the order you write them.<br /><h4><a href="https://www.home-assistant.io/docs/scripts/#delay">Delay</a></h4></div><div>You can pause before the actions run, or between actions, using a delay. This can be fixed for every run of the automation, or you can use templates to give you some flexibility.</div><h4><a href="https://www.home-assistant.io/docs/scripts/#wait">Wait</a></h4><div>Sometimes you want a pause, while you wait for something to happen. This is useful if you want an automation to run when a particular series of events happen, like maybe the front door to open, then the hall door to open within the next few minutes.</div><h4><a href="https://www.home-assistant.io/docs/scripts/#test-a-condition">Check a condition</a></h4><div>Sometimes you always want to do some of the actions, but only do the rest some of the time. If the condition is true, then the automation will continue. If it isn't, then the automation stops here.</div><h4>Do something</h4><div>Mostly you'll be <a href="https://www.home-assistant.io/docs/scripts/#call-a-service">calling a service</a>, to do something like turn on a light, or a switch, or send a notification, and so on. You can also <a href="https://www.home-assistant.io/docs/scripts/#fire-an-event">fire events</a> and do other things.</div><div><br /></div><div>We'll continue our dice rolling example:</div><pre>action:<br />  # Turn the lights red<br />  - service: light.turn_on<br />    data:<br />      entity_id: light.game_room<br />      color_name: "red"<br />  # Take a deep breath<br />  - delay: '00:00:05'<br />  # Did the character not die?<br />  - condition: state<br />    entity_id: sensor.character_health<br />    state: 'alive'<br />  # We're alive! Turn it white again<br />  - service: light.turn_on<br />    data:<br />      entity_id: light.game_room<br />      color_name: "white"<br /></pre>