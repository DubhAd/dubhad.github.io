---
layout: post
title: Messing with meshing
date: '2019-09-06T11:42:00.001+01:00'
author: Tinkerer
tags:
- zigbee
- z-wave
- home assistant
modified_time: '2019-09-06T11:42:43.476+01:00'
---

Back when I started with home automation, Z-Wave was the obvious choice for sensors, smart sockets. You could mix and match any brand of device, and controller, and things would work. Zigbee was more of a minefield at the time.<br /><br />The universe has moved on, and Zigbee is becoming more of a standard. Home Assistant now has two core Zigbee integrations with a wide range of supported devices (<a href="https://www.home-assistant.io/components/zha">zha</a> and <a href="https://www.home-assistant.io/components/deconz/">deconz</a>), and then there's <a href="https://www.zigbee2mqtt.io/">zigbee2mqtt</a>.<br /><br />I'd already stepped into Zigbee when I bought a Hue hub and compatible light strip controller, but hadn't intended to do much more than use the hub as a gateway for some lights. I had nothing but trouble with the hub though. It would regularly go <i>unavailable</i>&nbsp;for tens of minutes, so I accepted the prompt for a firmware upgrade, at the end of which the hub wouldn't respond to the Hue app. Nothing I did would bring it back to life, and given the previous trouble I'd had with it I decided it was time to jump fully in.<br /><h3>Which path?</h3>There's no right answer here, they each have advantages, disadvantages, and slightly different device support. Of course, with all of them you can add unsupported devices and help create support for them.<br /><br />I went with Zigbee2MQTT for two main reasons<br /><ol><li>I'm now using MQTT anyway for <a href="https://github.com/andrewjfreyer/monitor">monitor</a></li><li>I want something that I can upgrade and change separately from HA, to cut down on restarts</li></ol><div>All I needed to get started was to ditch that Hue hub, and buy all the parts needed to build a stick and a router. That takes too long to ship from the other side of the world, so while I did order the parts for flashing firmware, I ordered a <a href="http://zigbee2mqtt.discourse.group/t/ad-buy-ready2use-zigbee2mqtt-stick-flashed-antenna-mod-and-printed-case/22">pre-assembled controller and router</a>. Those came with antenna soldered on, and a nice case.</div><h3>And so, it begins</h3><div>Getting the&nbsp;Gledopto reset was a pain, but after a few dozen attempts, it worked. Because I worked on that over a few evenings, I had the time to order a small stack of Xiaomi devices - a bunch of door/window sensors, a <i>human body sensor</i>&nbsp;(motion and light levels), and a temperature and humidity sensor. Those almost all worked as I hoped. The door/window sensors are fantastic, and the temperature and humidity sensor works well. The motion and light sensor... is a good motion sensor, but it only reports light levels when there's motion (and it's not terribly sensitive at lower light levels). I've clearly been spoiled by the Z-Wave multi-sensors. Still, they have their uses.</div><div><br /></div><div>Still, I ordered a batch more of the door/window sensors, a couple more temperature and humidity sensors, and one of the <i>wireless switch</i>&nbsp;units - a little battery powered button.</div><div><br /></div><div>I've also started replacing some of the accent lighting with adjustable colour temperature units, which makes a rather pleasant change.<br /><h3>Going forwards</h3></div><div>I'm likely to stay with both, at least for the next few years. Neither of these are without issues - Z-Wave is relatively expensive, and Zigbee has (for me at least) been slightly less reliable - one device for instance left the mesh when it was power cycled, and refuses to re-join.</div>