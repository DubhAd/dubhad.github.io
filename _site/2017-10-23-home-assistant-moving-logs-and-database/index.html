<!DOCTYPE html>
<html lang="en">
<!-- Beautiful Jekyll 5.0.0 | Copyright Dean Attali 2020 -->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

  

  <title>Home Assistant - moving logs and database off the SD card</title>

  
  <meta name="author" content="Tinkerer">
  

  <meta name="description" content="One problem with running Home Assistant on a Pi is that SD cards aren&apos;t great for high write situations, and the database and logs can be very chatty. The answer is to move those to a USB thumb drive, and extend the life of your SD card.You&apos;ll want a USB...">

  

  

  
  <link rel="alternate" type="application/rss+xml" title="Tinkering with Technology" href="http://0.0.0.0:4000/feed.xml">
  

  

  

  

  


  
    
      
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">


    
      
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800">


    
  

  
    
      <link rel="stylesheet" href="/assets/css/bootstrap-social.css">
    
      <link rel="stylesheet" href="/assets/css/beautifuljekyll.css">
    
  

  

  
  
  

  

  
  <meta property="og:site_name" content="Tinkering with Technology">
  <meta property="og:title" content="Home Assistant - moving logs and database off the SD card">
  <meta property="og:description" content="One problem with running Home Assistant on a Pi is that SD cards aren&apos;t great for high write situations, and the database and logs can be very chatty. The answer is to move those to a USB thumb drive, and extend the life of your SD card.You&apos;ll want a USB...">

  
  <meta property="og:image" content="http://0.0.0.0:4000/assets/img/avatar.png">
  

  
  <meta property="og:type" content="article">
  <meta property="og:article:author" content="Tinkerer">
  <meta property="og:article:published_time" content="2017-10-23T20:42:00+01:00">
  <meta property="og:url" content="http://0.0.0.0:4000/2017-10-23-home-assistant-moving-logs-and-database/">
  <link rel="canonical" href="http://0.0.0.0:4000/2017-10-23-home-assistant-moving-logs-and-database/">
  

  
  <meta name="twitter:card" content="summary">
  
  <meta name="twitter:site" content="@">
  <meta name="twitter:creator" content="@">

  <meta property="twitter:title" content="Home Assistant - moving logs and database off the SD card">
  <meta property="twitter:description" content="One problem with running Home Assistant on a Pi is that SD cards aren&apos;t great for high write situations, and the database and logs can be very chatty. The answer is to move those to a USB thumb drive, and extend the life of your SD card.You&apos;ll want a USB...">

  
  <meta name="twitter:image" content="http://0.0.0.0:4000/assets/img/avatar.png">
  

  


  

  

</head>


<body>

  


  <nav class="navbar navbar-expand-xl navbar-light fixed-top navbar-custom top-nav-regular"><a class="navbar-brand" href="http://0.0.0.0:4000/">Tinkering with Technology</a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="main-navbar">
    <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="/aboutme">About Me</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</a>
            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="https://github.com/DubhAd/Home-AssistantConfig/">My HA config</a>
                  <a class="dropdown-item" href="https://www.home-assistant.io/docs/configuration/">Home Assistant documentation</a>
            </div>
          </li>
        
          <li class="nav-item">
            <a class="nav-link" href="https://ceard.tech">Author's home</a>
          </li>
        <li class="nav-item">
          <a class="nav-link" id="nav-search-link" href="#" title="Search">
            <span id="nav-search-icon" class="fa fa-search"></span>
            <span id="nav-search-text">Search</span>
          </a>
        </li></ul>
  </div>

  

  
    <div class="avatar-container">
      <div class="avatar-img-border">
        <a href="http://0.0.0.0:4000/">
          <img alt="Navigation bar avatar" class="avatar-img" src="/assets/img/avatar.png" />
        </a>
      </div>
    </div>
  

</nav>



<div id="beautifuljekyll-search-overlay">

  <div id="nav-search-exit" title="Exit search">âœ•</div>
  <input type="text" id="nav-search-input" placeholder="Search">
  <ul id="search-results-container"></ul>
  
  <script src="https://unpkg.com/simple-jekyll-search@latest/dest/simple-jekyll-search.min.js"></script>
  <script>
    var searchjson = '[ \
       \
        { \
          "title"    : "Traefik and a remote Home Assistant", \
          "category" : "remote accesshome assistant", \
          "url"      : "/2022-10-25-traefik-and-remote-home-assistant/", \
          "date"     : "October 25, 2022" \
        }, \
       \
        { \
          "title"    : "Frigate &gt; MotionEye+Doods", \
          "category" : "doodsfrigatehome assistantmotion detection", \
          "url"      : "/2022-09-20-frigate-motioneyedoods/", \
          "date"     : "September 20, 2022" \
        }, \
       \
        { \
          "title"    : "How should I install Home Assistant?", \
          "category" : "", \
          "url"      : "/2021-12-23-how-should-i-install-home-assistant/", \
          "date"     : "December 23, 2021" \
        }, \
       \
        { \
          "title"    : "Running an automation every time a sensor updates", \
          "category" : "automationhome assistant", \
          "url"      : "/2021-08-05-running-automation-every-time-sensor/", \
          "date"     : "August  5, 2021" \
        }, \
       \
        { \
          "title"    : "Why didn&#39;t my automation run?", \
          "category" : "", \
          "url"      : "/2021-07-18-why-didnt-my-automation-run/", \
          "date"     : "July 18, 2021" \
        }, \
       \
        { \
          "title"    : "Zigbee2MQTT - Native to Docker migration", \
          "category" : "dockerzigbee2mqtt", \
          "url"      : "/2021-05-02-zigbee2mqtt-native-to-docker-migration/", \
          "date"     : "May  2, 2021" \
        }, \
       \
        { \
          "title"    : "Presence Detection Resurrection", \
          "category" : "bluetoothhome assistantpresence detection", \
          "url"      : "/2021-01-03-presence-detection-resurrection/", \
          "date"     : "January  3, 2021" \
        }, \
       \
        { \
          "title"    : "HA venv to Docker", \
          "category" : "dockervenvlinuxpythonhome assistant", \
          "url"      : "/2020-10-10-ha-venv-to-docker/", \
          "date"     : "October 10, 2020" \
        }, \
       \
        { \
          "title"    : "Home Assistant, Docker, and using SSH", \
          "category" : "sshdockerhome assistant", \
          "url"      : "/2020-05-29-home-assistant-docker-and-using-ssh/", \
          "date"     : "May 29, 2020" \
        }, \
       \
        { \
          "title"    : "YAML in automations and scripts", \
          "category" : "yamlhome assistant coreautomationhome assistant", \
          "url"      : "/2020-05-13-yaml-in-automations-and-scripts/", \
          "date"     : "May 13, 2020" \
        }, \
       \
        { \
          "title"    : "Cameras, motion detection, and (interesting) object detection (part two)", \
          "category" : "", \
          "url"      : "/2020-05-10-cameras-motion-detection-and/", \
          "date"     : "May 10, 2020" \
        }, \
       \
        { \
          "title"    : "Moving from Wink to Home Assistant?", \
          "category" : "home assistant corehome assistantwink", \
          "url"      : "/2020-05-09-moving-from-wink-to-home-assistant/", \
          "date"     : "May  9, 2020" \
        }, \
       \
        { \
          "title"    : "Cameras, motion detection, and (interesting) object detection (part one)", \
          "category" : "doodsmotionhome assistant coremotion detectionobject detection", \
          "url"      : "/2020-04-28-cameras-motion-detection-and/", \
          "date"     : "April 28, 2020" \
        }, \
       \
        { \
          "title"    : "Presence detection, one last time?", \
          "category" : "monitorbluetoothgpsloggerproximityhome assistant corenmaphome assistantwifipresence detection", \
          "url"      : "/2020-04-14-presence-detection-one-last-time/", \
          "date"     : "April 14, 2020" \
        }, \
       \
        { \
          "title"    : "Zigbee (and Home Assistant)", \
          "category" : "zigbeez-wavehome assistant", \
          "url"      : "/2019-11-17-zigbee-and-home-assistant/", \
          "date"     : "November 17, 2019" \
        }, \
       \
        { \
          "title"    : "Presence detection, the final countdown?", \
          "category" : "monitorhome assistantpresence detection", \
          "url"      : "/2019-10-27-presence-detection-final-countdown/", \
          "date"     : "October 27, 2019" \
        }, \
       \
        { \
          "title"    : "Messing with meshing", \
          "category" : "zigbeez-wavehome assistant", \
          "url"      : "/2019-09-06-messing-with-meshing/", \
          "date"     : "September  6, 2019" \
        }, \
       \
        { \
          "title"    : "The great migration - part two", \
          "category" : "", \
          "url"      : "/2019-08-28-the-great-migration-part-two/", \
          "date"     : "August 28, 2019" \
        }, \
       \
        { \
          "title"    : "My great migration - part one", \
          "category" : "zigbeez-wavehome assistant", \
          "url"      : "/2019-08-15-my-great-migration-part-one/", \
          "date"     : "August 15, 2019" \
        }, \
       \
        { \
          "title"    : "Breaking up automations/Room activity detection", \
          "category" : "automationhome assistantpresence detection", \
          "url"      : "/2019-04-28-breaking-up-automationsroom-activity/", \
          "date"     : "April 28, 2019" \
        }, \
       \
        { \
          "title"    : "Presence detection - are we nearly there yet?", \
          "category" : "home assistantpresence detection", \
          "url"      : "/2019-03-16-presence-detection-are-we-nearly-there/", \
          "date"     : "March 16, 2019" \
        }, \
       \
        { \
          "title"    : "Product comparison - smart displays", \
          "category" : "smart displaygoogle homegoogle assistanthome assistant", \
          "url"      : "/2018-12-30-product-comparison-smart-displays/", \
          "date"     : "December 30, 2018" \
        }, \
       \
        { \
          "title"    : "Presence detection - update 3", \
          "category" : "", \
          "url"      : "/2018-10-15-presence-detection-update-3/", \
          "date"     : "October 15, 2018" \
        }, \
       \
        { \
          "title"    : "Upgrading from 0.75 to 0.80", \
          "category" : "home assistant", \
          "url"      : "/2018-10-13-upgrading-from-075-to-080/", \
          "date"     : "October 13, 2018" \
        }, \
       \
        { \
          "title"    : "Accessing the inaccessible", \
          "category" : "remote accessopenvpncloudpivpnhome assistantvpn", \
          "url"      : "/2018-09-29-accessing-inacessible/", \
          "date"     : "September 29, 2018" \
        }, \
       \
        { \
          "title"    : "Home Assistant cloud goes paid", \
          "category" : "cloudhome assistant", \
          "url"      : "/2018-09-18-home-assistant-cloud-goes-paid/", \
          "date"     : "September 18, 2018" \
        }, \
       \
        { \
          "title"    : "Presence detection updated", \
          "category" : "", \
          "url"      : "/2018-09-06-a-while-back-i-covered-how-i-was-doing/", \
          "date"     : "September  6, 2018" \
        }, \
       \
        { \
          "title"    : "Turbulence ahead - fasten your seatbelt", \
          "category" : "securityproxyhome assistant", \
          "url"      : "/2018-08-24-turbulence-ahead-fasten-your-seatbelt/", \
          "date"     : "August 24, 2018" \
        }, \
       \
        { \
          "title"    : "Sensative strips (guard) review", \
          "category" : "z-wave", \
          "url"      : "/2018-08-21-sensative-strips-guard-review/", \
          "date"     : "August 21, 2018" \
        }, \
       \
        { \
          "title"    : "Lovelace - the next generation of stock UI", \
          "category" : "", \
          "url"      : "/2018-08-19-lovelace-next-generation-of-stock-ui/", \
          "date"     : "August 19, 2018" \
        }, \
       \
        { \
          "title"    : "Triggers and conditions and actions! Oh My!", \
          "category" : "automationhome assistant", \
          "url"      : "/2018-08-18-triggers-and-conditions-and-actions-oh/", \
          "date"     : "August 18, 2018" \
        }, \
       \
        { \
          "title"    : "The XY Problem", \
          "category" : "", \
          "url"      : "/2018-08-16-the-xy-problem/", \
          "date"     : "August 16, 2018" \
        }, \
       \
        { \
          "title"    : "It&#39;s not about the brand", \
          "category" : "learningautomationhome assistant", \
          "url"      : "/2018-04-15-its-not-about-brand/", \
          "date"     : "April 15, 2018" \
        }, \
       \
        { \
          "title"    : "Home Assistant - the Hass.io menu is missing", \
          "category" : "hass.iohome assistant", \
          "url"      : "/2018-02-15-home-assistant-shopping-bag-is-missing/", \
          "date"     : "February 15, 2018" \
        }, \
       \
        { \
          "title"    : "Home Assistant, avoiding insecurity", \
          "category" : "securityremote accesshome assistant", \
          "url"      : "/2018-01-29-home-assistant-avoiding-insecurity/", \
          "date"     : "January 29, 2018" \
        }, \
       \
        { \
          "title"    : "Home Assistant and (basic) Presence Detection", \
          "category" : "home assistantpresence detection", \
          "url"      : "/2018-01-25-home-assistant-and-basic-presence/", \
          "date"     : "January 25, 2018" \
        }, \
       \
        { \
          "title"    : "The secret is (not) to bang the rocks together", \
          "category" : "helpvampirelearninghome assistant", \
          "url"      : "/2018-01-18-the-secret-is-not-to-bang-rocks-together/", \
          "date"     : "January 18, 2018" \
        }, \
       \
        { \
          "title"    : "How not to break manual control of devices with automations", \
          "category" : "input booleanautomationhome assistant", \
          "url"      : "/2018-01-17-how-not-to-break-manual-control-of/", \
          "date"     : "January 17, 2018" \
        }, \
       \
        { \
          "title"    : "Remote access via PiVPN", \
          "category" : "remote accessopenvpnpivpnhome assistantvpn", \
          "url"      : "/2018-01-17-remote-access-via-pivpn/", \
          "date"     : "January 17, 2018" \
        }, \
       \
        { \
          "title"    : "Why Home Assistant?", \
          "category" : "platformhome assistant", \
          "url"      : "/2018-01-11-why-home-assistant/", \
          "date"     : "January 11, 2018" \
        }, \
       \
        { \
          "title"    : "Remote access for Home Assistant (and other things)", \
          "category" : "remote accesshome assistant", \
          "url"      : "/2018-01-10-remote-access-for-home-assistant-and/", \
          "date"     : "January 10, 2018" \
        }, \
       \
        { \
          "title"    : "RFC1918", \
          "category" : "remote access", \
          "url"      : "/2018-01-09-rfc1918/", \
          "date"     : "January  9, 2018" \
        }, \
       \
        { \
          "title"    : "NGINX and Home Assistant", \
          "category" : "remote accesshome assistant", \
          "url"      : "/2018-01-09-nginx-and-home-assistant/", \
          "date"     : "January  9, 2018" \
        }, \
       \
        { \
          "title"    : "Installing Home Assistant in a virtual environment (in Linux)", \
          "category" : "venvpythonhome assistant", \
          "url"      : "/2017-12-25-installing-home-assistant-in-virtual/", \
          "date"     : "December 25, 2017" \
        }, \
       \
        { \
          "title"    : "Home Assistant Cloud", \
          "category" : "cloudhome assistant", \
          "url"      : "/2017-12-17-home-assistant-cloud/", \
          "date"     : "December 17, 2017" \
        }, \
       \
        { \
          "title"    : "Upgrading the Python Virtual Environment", \
          "category" : "venvpythonhome assistant", \
          "url"      : "/2017-12-08-upgrading-python-virtual-environment/", \
          "date"     : "December  8, 2017" \
        }, \
       \
        { \
          "title"    : "Which Home Assistant install is right for me?", \
          "category" : "hass.ioplatformhome assistant", \
          "url"      : "/2017-11-09-which-home-assistant-install-is-right/", \
          "date"     : "November  9, 2017" \
        }, \
       \
        { \
          "title"    : "LetsEncrypt with Home Assistant", \
          "category" : "sslhome assistant", \
          "url"      : "/2017-11-05-letsencrypt-with-home-assistant/", \
          "date"     : "November  5, 2017" \
        }, \
       \
        { \
          "title"    : "Backing up Hass.io", \
          "category" : "backuphass.io", \
          "url"      : "/2017-11-03-backing-up-hassio/", \
          "date"     : "November  3, 2017" \
        }, \
       \
        { \
          "title"    : "Choosing a platform", \
          "category" : "platform", \
          "url"      : "/2017-10-24-choosing-platform/", \
          "date"     : "October 24, 2017" \
        }, \
       \
        { \
          "title"    : "Backing up Home Assistant", \
          "category" : "backuphome assistant", \
          "url"      : "/2017-10-23-backing-up-home-assistant/", \
          "date"     : "October 23, 2017" \
        }, \
       \
        { \
          "title"    : "Home Assistant - moving logs and database off the SD card", \
          "category" : "home assistant", \
          "url"      : "/2017-10-23-home-assistant-moving-logs-and-database/", \
          "date"     : "October 23, 2017" \
        }, \
       \
        { \
          "title"    : "What&#39;s the point?", \
          "category" : "", \
          "url"      : "/2017-10-23-whats-point/", \
          "date"     : "October 23, 2017" \
        }, \
       \
        { \
          "title"    : "Putting the cart before the horse", \
          "category" : "", \
          "url"      : "/2017-10-22-putting-cart-before-horse/", \
          "date"     : "October 22, 2017" \
        }, \
       \
        { \
          "title"    : "Back it up", \
          "category" : "backup", \
          "url"      : "/2017-10-21-back-it-up/", \
          "date"     : "October 21, 2017" \
        }, \
       \
       \
        { \
          "title"    : "About", \
          "category" : "page", \
          "url"      : "/about/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "About me", \
          "category" : "page", \
          "url"      : "/aboutme/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "My website", \
          "category" : "page", \
          "url"      : "/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "", \
          "category" : "page", \
          "url"      : "/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Tag Index", \
          "category" : "page", \
          "url"      : "/tags/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "My website", \
          "category" : "page", \
          "url"      : "/page2/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "My website", \
          "category" : "page", \
          "url"      : "/page3/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "My website", \
          "category" : "page", \
          "url"      : "/page4/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "My website", \
          "category" : "page", \
          "url"      : "/page5/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "My website", \
          "category" : "page", \
          "url"      : "/page6/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "My website", \
          "category" : "page", \
          "url"      : "/page7/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "My website", \
          "category" : "page", \
          "url"      : "/page8/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "My website", \
          "category" : "page", \
          "url"      : "/page9/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "My website", \
          "category" : "page", \
          "url"      : "/page10/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "My website", \
          "category" : "page", \
          "url"      : "/page11/", \
          "date"     : "January 1, 1970" \
        } \
       \
    ]';
    searchjson = JSON.parse(searchjson);

    var sjs = SimpleJekyllSearch({
      searchInput: document.getElementById('nav-search-input'),
      resultsContainer: document.getElementById('search-results-container'),
      json: searchjson
    });
  </script>
</div>





  <!-- TODO this file has become a mess, refactor it -->







<header class="header-section ">

<div class="intro-header no-img">
  <div class="container-md">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
        <div class="post-heading">
          <h1>Home Assistant - moving logs and database off the SD card</h1>
          

          
            <span class="post-meta">Posted on 2017 October 23</span>
            
            
          
        </div>
      </div>
    </div>
  </div>
</div>
</header>





<div class=" container-md ">
  <div class="row">
    <div class=" col-xl-8 offset-xl-2 col-lg-10 offset-lg-1 ">

      

      

      <article role="main" class="blog-post">
        One problem with running <a href="https://home-assistant.io/">Home Assistant</a> on a Pi is that SD cards aren't great for high write situations, and the database and logs can be very chatty. The answer is to move those to a USB thumb drive, and extend the life of your SD card.<br /><br />You'll want a USB thumb drive of at least 16 GB, and I'd suggest a good quality one.<br /><h3>Prepare the drive</h3>First, connect the thumb drive to your Pi, then SSH to your Pi. There run the following command:<br /><blockquote class="tr_bq"><pre>$ sudo dmesg|tail -n 20|grep sd</pre></blockquote>you should see something like:<br /><blockquote class="tr_bq"><pre>[&nbsp; &nbsp; 3.773637] sd 0:0:0:0: [sda] 62333952 512-byte logical blocks: (31.9 GB/29.7 GiB)<br />[&nbsp; &nbsp; 3.783125] sd 0:0:0:0: [sda] Write Protect is off<br />[&nbsp; &nbsp; 3.791694] sd 0:0:0:0: [sda] Mode Sense: 0b 00 00 08<br />[&nbsp; &nbsp; 3.792618] sd 0:0:0:0: [sda] No Caching mode page found<br />[&nbsp; &nbsp; 3.801020] sd 0:0:0:0: [sda] Assuming drive cache: write through<br />[&nbsp; &nbsp; 3.817186]&nbsp; sda: sda1 sda2</pre></blockquote>The size should roughly agree with the size of the thumb drive you bought. In this case, my device is `sda` (the first USB drive that's attached).<br /><br />Now you'll partition the disk into two. One partition will hold the system logs, the other will hold your Home Assistant database. We'll do that with the following command (if your disk isn't sda, replace sda with your device):<br /><blockquote class="tr_bq"><pre>$ sudo parted /dev/sda</pre></blockquote>Now you list the existing partitions with the command <span style="background-color: #eeeeee; font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">p</span>, and then remove them with <span style="background-color: #eeeeee; font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">rm 1</span>, <span style="background-color: #eeeeee; font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">rm 2</span> and so on for each partition.<br /><br />Go back and have a look at the output of&nbsp;<span style="background-color: #eeeeee; font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">p</span>, it'll give you the size of the disk:<br /><blockquote class="tr_bq"><pre>Model: SanDisk Cruzer Fit (scsi)<br />Disk /dev/sdb: 31.5GB</pre></blockquote>We'll allocate half of this for the logs, and half of it for the database with the following commands:<br /><blockquote class="tr_bq"><pre>mkpart primary 2048s 50%<br />mkpart primary 50% 100%</pre></blockquote>Then type <span style="background-color: #eeeeee; font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">quit</span> to exit.<br /><h3>Add file systems</h3>Now you'll have 2 partitions <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">/dev/sda1</span> and <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">/dev/sda2</span>, but they need a file system:<br /><blockquote class="tr_bq"><pre>$ sudo mkfs -t ext4 /dev/sda1<br />$ sudo mkfs -t ext4 /dev/sda2</pre></blockquote>This will generate a number of lines out output, but the important one at the top is where it says <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">Filesystem UUID</span>, we'll be using that next.<br /><br />To use these file systems, edit <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">/etc/fstab</span> with your favourite editor (eg <span style="background-color: #eeeeee; font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">sudo vi /etc/fstab</span>) and add the following lines. Replace the parts starting&nbsp;<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">deadbeef-cafe</span><span style="font-family: inherit;">&nbsp;(the UUIDs) with the UUID, a different one on each line.</span><br /><blockquote class="tr_bq"><pre>UUID=deadbeef-cafe-dead-beef-cafef00f1234    /var/log    ext4    defaults,noatime,nofail    0    0<br />UUID=deadbeef-cafe-dead-beef-cafef00f5678    /data    ext4    defaults,noatime,nofail    0    0</pre></blockquote>You can separate those with tabs or spaces. Unlike YAML, it doesn't matter here. The <kbd>noatime</kbd> option says not to record the access (read) time of the files, which will save a lot of writes. The <kbd>nofail</kbd> option says that if the disk isn't found on boot to continue anyway.<br /><h3>Moving the Home Assistant database</h3>Making use of <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">/data</span> is easy:<br /><blockquote class="tr_bq"><pre>$ sudo mkdir /data<br />$&nbsp;sudo mount /data<br />$&nbsp;sudo chown homeassistant:homeassistant /data</pre></blockquote>Then update <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">configuration.yaml</span>&nbsp;with:<br /><blockquote class="tr_bq"><pre>recorder:<br />  db_url: sqlite:///data/home-assistant_v2.db</pre></blockquote>Now you can shut Home Assistant down, and move your existing database, then the logfile (and create a link for the logfile):<br /><blockquote class="tr_bq"><pre>$ sudo mv ~homeassistant/.homeassistant/home-assistant_v2.db /data/<br />$ sudo mv ~homeassistant/.homeassistant/home-assistant.log /data/<br />$ sudo ln -s /data/home-assistant.log ~homeassistant/.homeassistant/home-assistant.log</pre></blockquote><P>If you're using Z-Wave then you can move that log too: <blockquote class="tr_bq"><pre>$ sudo mv ~homeassistant/.homeassistant/OZW_Log.txt /data<br />$ sudo ln -s /data/OZW_Log.txt ~homeassistant/.homeassistant/OZW_Log.txt</pre><div></blockquote>When you start Home Assistant up, it'll now use the new location<br /><h3>Moving the log files</h3>Now we're going to make use of the way Linux handles files and do some fancy footwork:<br /><blockquote class="tr_bq"><pre>$ sudo mv /var/log /var/log-old<br />$ sudo mkdir /var/log<br />$ sudo mount /var/log</pre></blockquote>Now you've got some choices. The simplest solution is to simply reboot. This will cause everything currently using <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">/var/log</span> to use the partition you just mounted on <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">/var/log</span>. Your old log files will still exist in <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">/var/log-old</span>.<br /><br />If you don't want to reboot, you can identify the programs with a file open on&nbsp;<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">/var/log</span>&nbsp;with<br /><blockquote class="tr_bq"><pre>$ sudo lsof -n | grep "/var/log" | awk '{ print $1, $2 }'| uniq</pre></blockquote>This will give you a list of services you need to restart (and their process ID). Some names may not be obvious, so you might need to look at the output of<br /><blockquote class="tr_bq"><pre>$ sudo ps axu | grep " 1234 "</pre></blockquote>replacing 1234 with the process ID in question.<br /><h3>Also see</h3></div><div>Brian Cribbs has <a href="http://www.cribbstechnologies.com/index.php/home-automation/moving-home-assistant-logs/">written this article</a> on achieving the same goal, with a slightly different approach, and Carlo Costanzo's <a href="http://www.vmwareinfo.com/2017/10/moving-home-assistant-dbs-to-external.html">experiences doing this</a>.&nbsp;</div>
      </article>

      
        <div class="blog-tags">
          <span>Tags:</span>
          
            <a href="/tags#home assistant">home assistant</a>
          
        </div>
      

      

      
        <!-- Check if any share-links are active -->




<section id = "social-share-section">
  <span class="sr-only">Share: </span>

  
    <a href="https://twitter.com/intent/tweet?text=Home+Assistant+-+moving+logs+and+database+off+the+SD+card&url=http%3A%2F%2F0.0.0.0%3A4000%2F2017-10-23-home-assistant-moving-logs-and-database%2F"
      class="btn btn-social-icon btn-twitter" title="Share on Twitter">
      <span class="fab fa-fw fa-twitter" aria-hidden="true"></span>
      <span class="sr-only">Twitter</span>
    </a>
  

  
    <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2F0.0.0.0%3A4000%2F2017-10-23-home-assistant-moving-logs-and-database%2F"
      class="btn btn-social-icon btn-facebook" title="Share on Facebook">
      <span class="fab fa-fw fa-facebook" aria-hidden="true"></span>
      <span class="sr-only">Facebook</span>
    </a>
  

  
    <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2F0.0.0.0%3A4000%2F2017-10-23-home-assistant-moving-logs-and-database%2F"
      class="btn btn-social-icon btn-linkedin" title="Share on LinkedIn">
      <span class="fab fa-fw fa-linkedin" aria-hidden="true"></span>
      <span class="sr-only">LinkedIn</span>
    </a>
  

  

  

</section>



      

      <ul class="pagination blog-pager">
        
        <li class="page-item previous">
          <a class="page-link" href="/2017-10-23-whats-point/" data-toggle="tooltip" data-placement="top" title="What&apos;s the point?">&larr; Previous Post</a>
        </li>
        
        
        <li class="page-item next">
          <a class="page-link" href="/2017-10-23-backing-up-home-assistant/" data-toggle="tooltip" data-placement="top" title="Backing up Home Assistant">Next Post &rarr;</a>
        </li>
        
      </ul>
      
  
  
  

  


  

  



    </div>
  </div>
</div>


  <footer>
  <div class="container-md beautiful-jekyll-footer">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
      <ul class="list-inline text-center footer-links"><li class="list-inline-item">
    <a href="/feed.xml" title="RSS">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">RSS</span>
    </a>
  </li><li class="list-inline-item">
    <a href="https://github.com/DubhAd" title="GitHub">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-github fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">GitHub</span>
   </a>
  </li></ul>

      
      <p class="copyright text-muted">
      
        Tinkerer
        &nbsp;&bull;&nbsp;
      
      2022

      

      

      

      </p>
      <p class="theme-by text-muted">
        Powered by
        <a href="https://beautifuljekyll.com">Beautiful Jekyll</a>
      </p>
      </div>
    </div>
  </div>
</footer>


  
  
    
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" crossorigin="anonymous"></script>


  
    
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>


  
    
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>


  



  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
      <script src="/assets/js/beautifuljekyll.js"></script>
    
  









</body>
</html>
