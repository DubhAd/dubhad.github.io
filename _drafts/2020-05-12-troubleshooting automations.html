---
layout: post
title: Troubleshooting automations
date: '2020-05-12T21:50:00.002+01:00'
author: Tinkerer
tags:
- home assistant core
- automation
modified_time: '2020-05-12T21:50:49.125+01:00'
---

<div>It's fairly rare that an automation does what you expect first time, so how can you troubleshoot it?</div><h2 style="text-align: left;">The action</h2><div style="text-align: left;">Use the <kbd>automation.trigger</kbd>&nbsp;service and don't set the&nbsp;<kbd>skip_condition</kbd>.&nbsp;If everything worked, you're ready to test the conditions. If it didn't then it's time to check the log file for any warnings or errors. You may need to set the <kbd><a href="https://www.home-assistant.io/integrations/logger" target="_blank">logger</a></kbd> to <kbd>info</kbd> to get enough information (it's pretty rare you need <kbd>debug</kbd> for troubleshooting automations). Any failed condition, or failed service call, will cause the action to stop there.&nbsp;</div><div style="text-align: left;"><br /></div><div style="text-align: left;">Where it's not been obvious what's gone wrong, I've used a <a href="https://www.home-assistant.io/integrations/file/#notifications" target="_blank">file notifier</a> to <a href="https://github.com/DubhAd/Home-AssistantConfig/blob/master/notify/logfile.yaml" target="_blank">create my own debug logs</a>. For example:</div><div style="text-align: left;"><pre style="text-align: left;">&nbsp; &nbsp; action:<br />&nbsp; &nbsp; &nbsp; - service: notify.logfile<br />&nbsp; &nbsp; &nbsp; &nbsp; data:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; message: "Beginning the action"<br />&nbsp; &nbsp; &nbsp; - service: switch.turn_on<br />&nbsp; &nbsp; &nbsp; &nbsp; entity_id: switch.furnace<br />&nbsp; &nbsp; &nbsp; - service: notify.logfile<br />&nbsp; &nbsp; &nbsp; &nbsp; data:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; message: "Turned on the furnace"<br />&nbsp; &nbsp; &nbsp; - delay: "00:01:00<br />&nbsp; &nbsp; &nbsp; - service: notify.logfile<br />&nbsp; &nbsp; &nbsp; &nbsp; data:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; message: "Delay is over"<br />&nbsp; &nbsp; &nbsp; - service: switch.turn_off<br />&nbsp; &nbsp; &nbsp; &nbsp; entity_id: switch.furnace</pre><div>Now I can check the file that notifier is writing to and find where it got to before it fell over. I actually use that notifier in many places so I can record what's going on.</div><h2 style="text-align: left;">The condition</h2><div><div>Once you know the action works, you can test the conditions by going to the&nbsp;<i>Developer Tools</i>&nbsp;menu, then&nbsp;<i>Services</i>. Here you want to select the&nbsp;<kbd>automation.trigger</kbd>&nbsp;service, select your automation, and then fill the following in the second line of the&nbsp;<i>Service Data</i>&nbsp;block:</div><pre style="text-align: left;">skip_condition: False</pre><div>This will then evaluate the conditions, but ignore the triggers, before running the actions (assuming the conditions pass). If this doesn't work, then it means your conditions aren't met. The most common cause is that you're using the human readable state listed in the user interface, rather than the actual entity state that you see in <i>Developer Tools</i>&nbsp;then <i>States</i>.</div></div><div><br /></div><div>You can also move the conditions into the action block, if you want to use the same notifier trick.</div><h2 style="text-align: left;">The trigger</h2><div>Now you know the condition and the actions are good, it's time to check the trigger.&nbsp;</div><div><br /></div><div>You can do so by going to&nbsp;<i>Developer Tools</i>&nbsp;then&nbsp;<i>States</i>. Find your entity and click it, now at the top of the page you'll find the current state (and attributes) pre-filled. You can change the state and attributes, then press&nbsp;<i>Set State</i>. This will change what Home Assistant thinks, and so trigger any automations using that entity.</div><div><br /></div><div>This, of course, tests the trigger with the value you enter. If that's not an actual valid state for that entity, you're not really testing correctly. Always check the real states by looking at the entity in <i>Developer Tools</i>&nbsp;then <i>States</i>.</div><div><br /></div><div>Your other option is to have the underlying device do whatever it needs. For instance, have the phone leave home (putting it into airplane mode is usually enough), or open the window, or ... whatever it is.</div></div>